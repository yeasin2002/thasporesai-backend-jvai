### Password Reset Flow Tests
@baseUrl = http://localhost:4000
@email = test@example.com

###############################################
# Step 1: Request OTP (Forgot Password)
###############################################
POST {{baseUrl}}/api/auth/forgot-password
Content-Type: application/json

{
  "email": "{{email}}"
}

###############################################
# Step 2: Verify OTP
# (Check console for OTP code)
###############################################
POST {{baseUrl}}/api/auth/verify-otp
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "123456"
}

###############################################
# Step 3: Reset Password
###############################################
POST {{baseUrl}}/api/auth/reset-password
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "123456",
  "newPassword": "newPassword123"
}

###############################################
# Step 4: Login with New Password
###############################################
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "newPassword123"
}

###############################################
# Error Test Cases
###############################################

### Test: Invalid OTP
POST {{baseUrl}}/api/auth/verify-otp
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "000000"
}

### Test: OTP with wrong length
POST {{baseUrl}}/api/auth/verify-otp
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "123"
}

### Test: Missing email
POST {{baseUrl}}/api/auth/verify-otp
Content-Type: application/json

{
  "otp": "123456"
}

### Test: Invalid email format
POST {{baseUrl}}/api/auth/forgot-password
Content-Type: application/json

{
  "email": "invalid-email"
}

### Test: Try to use OTP twice (after reset)
POST {{baseUrl}}/api/auth/verify-otp
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "123456"
}

### Test: Reset with weak password
POST {{baseUrl}}/api/auth/reset-password
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "123456",
  "newPassword": "123"
}

###############################################
# Complete Flow Test
###############################################

### 1. Register a test user
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "name": "Test User",
  "email": "{{email}}",
  "password": "password123",
  "role": "customer"
}

### 2. Request OTP
POST {{baseUrl}}/api/auth/forgot-password
Content-Type: application/json

{
  "email": "{{email}}"
}

### 3. Verify OTP (use OTP from console)
POST {{baseUrl}}/api/auth/verify-otp
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "REPLACE_WITH_OTP_FROM_CONSOLE"
}

### 4. Reset Password
POST {{baseUrl}}/api/auth/reset-password
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "REPLACE_WITH_OTP_FROM_CONSOLE",
  "newPassword": "newSecurePassword123"
}

### 5. Login with new password
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "newSecurePassword123"
}
